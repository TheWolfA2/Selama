@using Selama.Areas.Admin.ViewModels.Users;
@model UserOverviewViewModel

@{
    ViewBag.Title = "User Overview";
}

@section Scripts {
    <script type="text/javascript">
        function onConfirmUser(e)
        {
            var $tr = $(e.target).closest("tr[data-user]");

        }
        function onConfirmUser_Success(response)
        {

        }
        function onConfirmUser_Error(response)
        {

        }
    </script>
}

<h2>User Overview</h2>

<div class="row pager-row">
    <div class="col-md-offset-2 col-md-10">
        @Html.Partial("_UsersOverviewPager", Model)
    </div>
</div>
<div class="row">
    <table class="table table-striped">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => new UserViewModel().UserName)
                </th>
                <th>
                    @Html.DisplayNameFor(model => new UserViewModel().Email)
                </th>
                <th style="text-align: center;">
                    @Html.DisplayNameFor(model => new UserViewModel().IsEmailConfirmed)
                </th>
                <th style="text-align: center;">
                    @Html.DisplayNameFor(model => new UserViewModel().IsActive)
                </th>
                <th style="text-align: center;">
                    @Html.DisplayNameFor(model => new UserViewModel().WaitingReview)
                </th>
                <th>
                    Enable/Disable User
                </th>
                <th>
                    @* Commands *@
                </th>
            </tr>
        </thead>
        <tbody>
            @foreach (var user in Model.Users)
            {
                <tr class="user-overview-row" data-user="@user.UserId" data-user-active="@user.IsActive">
                    <td>
                        @Html.DisplayFor(modelItem => user.UserName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => user.Email)
                    </td>
                    <td align="center">
                        @if (user.IsEmailConfirmed)
                        {
                            <span class="fa fa-check text-success"></span>
                        }
                        else
                        {
                            <span class="fa fa-times text-danger"></span>
                        }
                    </td>
                    <td align="center">
                        @if (user.IsActive)
                        {
                            <span class="fa fa-check text-success"></span>
                        }
                        else
                        {
                            <span class="fa fa-times text-danger"></span>
                        }
                    </td>
                    <td align="center">
                        @if (user.WaitingReview)
                        {
                            <span class="fa fa-check text-success"></span>
                        }
                        else
                        {
                            <span class="fa fa-times text-danger"></span>
                        }
                    </td>
                    <td align="center">
                        @if (user.IsActive)
                        {
                            @using (Html.BeginForm("DisableUser"))
                            {
                                @Html.HiddenFor(modelItem => user.UserId)
                                <button type="submit" class="btn btn-danger">
                                    Disable
                                </button>
                            }
                        }
                        else
                        {
                            @using (Html.BeginForm("EnableUser"))
                            {
                                @Html.HiddenFor(modelItem => user.UserId)
                                <button type="submit" class="btn btn-success">
                                    Enable
                                </button>
                            }
                        }
                    </td>
                    <td>
                        @if (user.WaitingReview)
                        {
                            @using (Html.BeginForm("ConfirmUser"))
                            {
                                @Html.HiddenFor(modelItem => user.UserId)
                                <button type="submit" class="btn btn-primary btn-icontext btn-confirm">
                                    <span class="fa fa-check"></span>
                                    Confirm user
                                </button>
                            }
                            @using (Html.BeginForm("DenyUser"))
                            {
                                @Html.HiddenFor(modelItem => user.UserId)
                                <button type="submit" class="btn btn-default btn-icontext btn-deny">
                                    <span class="fa fa-times"></span>
                                    Deny user
                                </button>
                            }
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
<div class="row pager-row">
    <div class="col-md-offset-2 col-md-10">
        @Html.Partial("_UsersOverviewPager", Model)
    </div>
</div>